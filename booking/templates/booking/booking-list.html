{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<!-- Booking list -->
<div class="container">
  <div class="row">
    <div class="col-12">
      <h3 class="list-title">My Bookings</h3>
    </div>

    <div class="col">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th scope="col">Number of Guests</th>
            <th scope="col">Status</th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          {% for booking in bookings %}
          <tr>
            <th scope="row">{{ booking.date }}</th>
            <td>{{ booking.time }}</td>
            <td>{{ booking.number_of_guests }}</td>
            <td>
              {% if booking.status == 1 %}Confirmed
              {% elif booking.status == 2 %}Cancelled
              {% elif booking.status == 3 %}Rejected
              {% else %}Pending
              {% endif %}
            </td>
            {% if booking.status != 2 and booking.status != 3 %}
            <td>
              <button
                class="btn openUpdateModal"
                data-url="{% url 'bookingUpdate' booking.pk %}"
              >
                Update
              </button>
              <button
                class="btn openDeleteModal"
                data-url="{% url 'bookingDelete' booking.pk %}"
              >
                Delete
              </button>
            </td>
            {% else %}
            <td><em>No actions available</em></td>
            {% endif %}
          </tr>
          {% empty %}
          <tr>
            <td colspan="5">No existing bookings!</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="row mt-3">
    <div class="col">
      <button
          id="openCreateModal"
          class="btn btn-primary"
          data-url="{% url 'bookingForm' %}"
        >
          Make a New Booking
      </button>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/modals.js' %}"></script>
{% endblock %}